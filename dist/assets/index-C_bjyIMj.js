(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const n of o.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&r(n)}).observe(document,{childList:!0,subtree:!0});function t(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(s){if(s.ep)return;s.ep=!0;const o=t(s);fetch(s.href,o)}})();const p=i=>{let e=i.length,t;for(;e!==0;)t=Math.floor(Math.random()*e),e--,[i[e],i[t]]=[i[t],i[e]];return i},f=()=>{let i=0,e=0,t=0,r=0;const s=JSON.parse(localStorage.getItem("timer"));s&&(i=s.ms,e=s.s,t=s.m,r=s.h);let o=null;const n=()=>{o||(o=setInterval(()=>{i++,i==100&&(i=0,e++),e==60&&(e=0,t++),t==60&&(t=0,r++);let g=[r,t,e,i];localStorage.setItem("crono",JSON.stringify(g)),m()},10))},a=()=>{clearInterval(o),o=null},c=()=>{a(),i=0,e=0,t=0,r=0,m()},d=()=>[r,t,e,i],m=()=>{document.getElementById("displaytime").innerText=`${r<10?"0"+r:r}:${t<10?"0"+t:t}:${e<10?"0"+e:e}:${i<10?"0"+i:i}`,localStorage.setItem("timer",JSON.stringify({h:r,m:t,s:e,ms:i}))};return m(),{start:n,stop:a,reset:c,getTime:d}},y=i=>{const e=Math.floor(i/36e4),t=Math.floor(i%(6e3*60)/6e3),r=Math.floor(i%6e3/100),s=i%100,o=n=>String(n).padStart(2,"0");return`${o(e)}:${o(t)}:${o(r)}:${o(s)}`},l=i=>JSON.parse(localStorage.getItem(i)),u=(i,e)=>{localStorage.setItem(i,JSON.stringify(e))};class v extends EventTarget{#r;#t;#s;#e;#o;constructor(e,t,r){super(),this.#r=e,this.#t=t,this.game=r,this.#e=this.#o=!1}get id(){return this.#r}get color(){return this.#t}get volteada(){return this.#o}set volteada(e){e!==this.#o&&(this.#o=e,this.dispatchEvent(new CustomEvent("cambioVolteada",{detail:{valor:e}})))}get resuelta(){return this.#e}set resuelta(e){return this.#e=e}get element(){return this.#s}draw=()=>{const e=document.createElement("div");e.classList.add("face","front");const t=document.createElement("div");t.classList.add("face","back"),this.volteada&&(t.style.backgroundColor=this.#t);const r=document.createElement("div");r.id=this.#r,r.dataset.color=this.#t,r.classList.add("card"),this.volteada&&r.classList.add("flipped"),r.append(e),r.append(t);const s=document.createElement("div");return s.classList.add("card-container"),this.volteada&&(s.style.cursor="inherit"),s.append(r),this.#s=s,this.initListeners(),s};openCard=()=>{const e=this.#s.querySelector(".card");e.querySelector(".back").style.backgroundColor=this.#t,e.classList.toggle("flipped"),e.addEventListener("transitionend",t=>{},{once:!0})};closeCard=()=>{const e=this.#s.querySelector(".card");e.classList.toggle("flipped"),e.addEventListener("transitionend",t=>{},{once:!0})};initListeners=()=>{this.#s.addEventListener("mousedown",()=>{this.game.dragging=!0,this.game.toFront(this),this.game.timerStart(),this.game.currentCard=this}),this.#s.addEventListener("mouseup",()=>{this.game.dragging=!1,this.game.closeOpenCards(this),this.game.recolocar(),this.game.checkMatch(this),this.resuelta||(this.volteada?this.volteada=!1:this.volteada=!0)}),this.addEventListener("cambioVolteada",e=>{e.detail.valor?this.openCard():this.closeCard()})}}class h{#r;#t;#s;#e;#o;#l;#c;#d;#i;#n;#a;constructor(e){this.promptbox(),this.#c=this.#d=0,this.#n=e,this.#l=!1,this.initListeners(),l("records")&&this.displayRecords()}set rows(e){this.#t=e}set cols(e){this.#r=e}set currentCard(e){this.#o=e}get dragging(){return this.#l}set dragging(e){this.#l=e}static checkStorage=()=>{localStorage.getItem("settings")||this.resetStorage()};static resetStorage=()=>{localStorage.removeItem("settings"),localStorage.removeItem("timer"),localStorage.removeItem("cards")};promptbox=()=>{this.#a=!1;const e=document.getElementById("promptbox");for(const r of e.querySelectorAll("input[type=number]"))r.value="";e.querySelector("#rows").addEventListener("input",r=>{e.querySelector("#rowsvalue").textContent=r.target.value}),e.querySelector("#cols").addEventListener("input",r=>{e.querySelector("#colsvalue").textContent=r.target.value}),e.querySelector("form").addEventListener("submit",r=>{r.preventDefault();const s=parseInt(document.querySelector("input[id=rows]").value),o=parseInt(document.querySelector("input[id=cols]").value),n=s*o;if(n%2)document.getElementById("errormessage").style.opacity=1;else{this.#t=s,this.#r=o,this.#s=n,u("settings",{rows:s,cols:o}),e.style.display="none";const a=p(this.generateColors());this.initGrid(a),this.drawCards()}});const t=l("settings");if(t){this.#t=t.rows,this.#r=t.cols,this.#s=t.rows*t.cols,t.finjuego&&(this.#a=t.finjuego);const s=l("cards").map(o=>o.color);this.initGrid(s),this.drawCards()}else localStorage.removeItem("timer"),localStorage.removeItem("cards"),e.style.display="block"};timerStart=()=>{this.#a||this.#n.start()};generateColors=()=>{const e=["maroon","red","purple","fuchsia","green","lime","olive","yellow","navy","blue","teal","aqua","antiquewhite","aquamarine","brown","burlywood","cadetblue","chocolate","coral","cornflowerblue","darkgoldenrod","darkgray","darkolivegreen","darkorange","darksalmon","darkseagreen","darkslateblue","darkslategray","darkturquoise","deeppink","dodgerblue","firebrick","gold","indianred","indigo","khaki","lavender","lightblue","lightcoral","lightcyan","lightsalmon","lightslategrey","lightsteelblue","midnightblue","navajowhite","olivedrab","orange","palegreen","palevioletred","rosybrown"];let t=[];const r=this.#s/2,s=[...e];for(let o=0;o<r;o++){const n=Math.floor(Math.random()*s.length),a=s.splice(n,1)[0];t.push(a,a)}return t};initGrid=e=>{this.#e=[];let t=[];const r=l("cards");for(let s=0;s<this.#s;s++){const o=new v(s,e[s],this);let n=!1;r&&(n=r[s].resuelta,n&&(o.resuelta=o.volteada=!0)),this.#e.push(o),t.push({id:s,color:e[s],resuelta:n,volteada:n})}u("cards",t)};drawCards=()=>{const e=document.getElementById("cuadricula");e.textContent="";const t=5*(this.#t-1)+40,r=parseInt((485-t)/this.#t);e.style.gridTemplateRows=`repeat(${this.#t}, ${r}px)`,e.style.gridTemplateColumns=`repeat(${this.#r}, 1fr)`;for(let s=0;s<this.#s;s++){let n=this.#e[s].draw();e.appendChild(n)}};closeOpenCards=e=>{for(const t of this.#e)t!==e&&t.volteada&&!t.resuelta&&(t.volteada=!1)};checkMatch=e=>{if(this.#i&&this.#i!==e){const t=this.#i.element.querySelector(".card");t.style.border="none";const r=t.id;if(e.color===this.#e[r].color){e.resuelta=!0,this.#e[r].resuelta=!0,e.element.style.cursor="inherit",this.#e[r].element.style.cursor="inherit",this.#e[r].volteada=!0;const s=l("cards");s[e.id].resuelta=s[this.#e[r].id].resuelta=!0,u("cards",s);for(const o of this.#e)o.resuelta;if(this.checkFinJuego()){this.#n.stop(),this.#a=!0;const o=l("settings");o.finjuego=!0,u("settings",o),this.checkRecords()}}this.#i=null}};checkRecords=()=>{let e=l("records")||{};const t=this.#n.getTime(),r=((t[0]*60+t[1])*60+t[2])*100+t[3],s=e[this.#s];(!s||r<s)&&(e[this.#s]=r,u("records",e),this.displayRecords(),document.getElementById("msgnewrecord").style.display="block")};displayRecords=()=>{let e=l("records");if(e){const t=document.getElementById("records");t.style.display||(t.style.display="block");let r=t.querySelector("#records > div:last-of-type");r.textContent="";const s=document.createElement("div");s.textContent="NÃºmero de cartas:",r.append(s);const o=document.createElement("div");o.textContent="tiempo:",r.append(o);for(const[n,a]of Object.entries(e)){const c=document.createElement("div");c.classList.add("titlerecord"),c.append(n),r.append(c);const d=document.createElement("div");d.classList.add("valurecord"),d.append(y(a)),r.append(d)}}};checkFinJuego=()=>this.#e.reduce((t,r)=>r.resuelta?t+1:t,0)===this.#s;toFront=e=>{for(const t of this.#e)t.element.style.zIndex=0;e.element.style.zIndex=1};recolocar=()=>{for(const e of this.#e)e.element.style.left=0,e.element.style.top=0};initListeners=()=>{document.getElementById("reiniciar").addEventListener("click",()=>{this.#a=!1,this.#n.reset(),h.resetStorage();for(const e of this.#e)e.resuelta=!1,e.volteada=!1,e.element.style.cursor="pointer";this.#t=3,this.#r=4,document.getElementById("errormessage").style.opacity=0,document.getElementById("rowsvalue").textContent=this.#t,document.getElementById("colsvalue").textContent=this.#r,document.getElementById("rows").value=this.#t,document.getElementById("cols").value=this.#r,document.getElementById("promptbox").style.display="inherit"}),document.getElementById("btnNewRecord").addEventListener("click",e=>{document.getElementById("msgnewrecord").style.display="none"}),document.addEventListener("mousedown",e=>{this.#c=e.clientX,this.#d=e.clientY}),document.addEventListener("mousemove",e=>{if(this.#o){if(this.#o.resuelta)return;if(this.#l&&this.#o.volteada){const t=this.#o.element;t.style.left=e.clientX-this.#c+"px",t.style.top=e.clientY-this.#d+"px",t.style.pointerEvents="none";const r=document.elementFromPoint(e.clientX,e.clientY).parentElement;if(r.classList.contains("card")){if(this.#i){const s=this.#i.element.querySelector(".card");r!==s&&(s.style.border="none")}this.#i=this.#e[r.id],r.style.border="dashed yellow"}t.style.pointerEvents="auto"}}})}}h.checkStorage();const S=f();new h(S);
